# 올라락! 깨구락!

## 프로젝트 설명
<b><올라락! 깨구락!></b>은 <b>샌드박스 기능을 통한 유저 기반 무한 확장 컨텐츠(UGC)</b>를 제공하며, AI 컨텐츠 및 서비스가 접목된 3D 플랫폼 게임입니다.

### 대표 영상

https://github.com/user-attachments/assets/ab9bfd88-c8a0-4c61-9e06-0d259c62a0cd

> [해당 링크를 클릭하면 유튜브에서 보실 수 있습니다.](https://youtu.be/ora28k2jDWk)

---

## 역할 및 목표
**역할:**  
- 샌드박스 시스템(맵 에디팅) 제작 및 구현
- 통신 모듈 구현  
- 카테고리 시스템 및 스테이지 시스템 개발  

**목표:**
- 언리얼 엔진 5와 유사한, **객체 조작감에 있어 최상위 수준의 부드러운 조작감**을 제공하는 것을 목표로 함.

---

## 주요 기능

### 샌드박스 시스템
> 플레이어가 직접 맵을 제작·편집하고 공유할 수 있도록 하는 **UGC(User Generated Content) 핵심 기능**입니다.  
> 이 시스템을 기반으로 아래와 같은 기능들을 구현했습니다.

---

### 01. 3D 그리드 시스템 및 스냅 이동
객체를 정해진 `Snap` 사이즈 만큼 정렬되도록 하였습니다.
이를 기반으로 사이즈를 고려한 스냅 이동 등을 구현합니다.
현재 프로젝트에서는 50의 사이즈로 정렬됩니다.

**시연 영상**

https://github.com/user-attachments/assets/d203a732-fbbf-4a37-80f4-3512fdbca4c4

**설명**
- 부동소수점을 고려하여 그리드 시스템을 구현하였고 이로 인하여 부정확한 배치를 방지하였습니다.

**소스 코드**


---

### 02. 객체 조작 (기즈모 이동, 회전)
언리얼 엔진 에디터와 유사한 방식으로 오브젝트를 직관적으로 다룰 수 있는 조작 시스템입니다.  

- 이동, 회전 및 다중 객체 조작 지원  
- 시각적 피드백을 통한 정밀한 배치 가능  

**시연 영상**

https://github.com/user-attachments/assets/b0ad3b1a-2b57-4991-8ef8-8328f35f048e

**설명**
- 편미분을 활용한 최소거리 지점 공식을 사용하여 3축 기즈모 이동을 구현하였습니다.
- 쿼터니안을 활용하여 회전을 구현하였습니다.
- 스택 자료구조 기반 객체 관리를 통하여 다중 조작을 할 수 있게 되었습니다.

**소스 코드**

---

### 03. 카테고리 시스템 & 드래그 드롭 & 검색
- 카테고리 시스템을 통해 객체를 분류하였습니다.
- 드래그 앤 드롭으로 물체를 배치할 수 있도록 구현하였습니다.
- 또한 검색 기능을 추가하여 원하는 객체를 바로 찾을 수 있도록 하였습니다.

**시연 영상**

https://github.com/user-attachments/assets/12110277-3e56-4466-98ba-179b462397c6

**설명**
- 데이터 테이블을 활용하여 객체의 정보를 효율적으로 다루었습니다.
- 카테고리 UI를 구성할 경우 Object Pooling을 통하여 메모리 단편화를 최소화하였습니다.
- 포인트 배열 및 Map 등을 활용하여 불필요한 메모리 할당을 줄이고 빠른 탐색을 할 수 있도록 구현하였습니다.

**소스 코드**

---

### 04. 좌표계 불일치 문제 해결
객체 UI를 드래그 드롭할 때 좌표계가 일치하지 않아, 마우스와 일치되지 않는 곳에 객체가 설치되었습니다.

이를 다음과 같이 해결하였습니다.

1. 스크린 좌표계 추출
2. 뷰포트 정규화
3. 뷰포트 내부 픽셀 좌표로 변환

이로 인하여 마우스와 일치된 곳에 객체가 생성되고 드래그 비쥬얼 UI 또한 마우스와 일치한 곳에 위치시킬 수 있었습니다.

**시연 영상**


https://github.com/user-attachments/assets/b2e2e77c-2e14-4810-ac86-560e1fa940e5


**소스 코드**

---

### 05. 파일 브라우저 문제 해결
언리얼 엔진 5의 경우 패키징 시 기본적으로 제공되는 파일 브라우저 API를 사용할 수 없었습니다.
이를 직접 UI를 통해 구현하였고 문제를 해결할 수 있었습니다.

**시연 영상**

https://github.com/user-attachments/assets/28ffb3af-2231-4e8f-8bcc-bcbd10f70ba9

**소스 코드**

---

## 게임

### 06. 로비 화면 캐릭터 마우스 따라가게 하기
마우스 위치를 따라 캐릭터의 고개를 움직이게 하는 기능을 구현하였습니다.

**시연 영상**


https://github.com/user-attachments/assets/527edb62-70af-474a-8836-859c8c5a2d09


**설명**
다음의 순서로 문제를 해결하였습니다.

1. **전치 행렬**을 사용하여 캐릭터의 좌표를 카메라의 좌표계(카메라 로컬 좌표계)로 변환
2. 마우스 좌표를 월드 좌표로 변환
3. 해당 좌표를 카메라의 로컬 좌표계로 변환 (전치 행렬 사용)
4. 화면 최소·최대 좌표 기준으로 마우스 위치의 비율을 구해 깨구락의 Pitch와 Roll 계산

**소스 코드**

---

## 통신 모듈

### 07. 통신 모듈
시선 추적, 맵 제작 AI 에이전트, 이미지 검색, 음성 퀴즈 등 다양한 AI 서버와의 연동에 따라 복잡한 통신 스택이 요구되었고, 이를 통합적으로 대응하기 위한 통신 모듈을 개발하였습니다.

**통신 아키텍쳐**
<img width="354" height="230" alt="image" src="https://github.com/user-attachments/assets/b01ecc92-d926-4de5-a8e9-3708da6318f0" />

**설명**
- WebSocket, IPC, HTTPS를 아우르는 통신 인터페이스 구현
- Union(공용체) 기반 바이너리 통신 처리를 도입하여 메모리 공유 시 형 변환에 따른 자동 파싱 설계

**소스 코드**
